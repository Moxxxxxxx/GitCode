SELECT DATE_FORMAT( DATE_SUB( DATE_ADD(DATE_FORMAT(now(),'%Y-%m-%d 00:00:00'),INTERVAL -1 DAY),INTERVAL ( -(@i:=@i+1) ) HOUR ) ,'%Y-%m-%d %H:00:00') as theDayStartofhour,
             DATE_FORMAT( DATE_SUB( DATE_ADD(DATE_FORMAT(now(),'%Y-%m-%d 00:00:00'),INTERVAL -1 DAY),INTERVAL ( -(@i:=@i) ) HOUR ) ,'%Y-%m-%d %H:59:59') AS theDayEndofhour
      FROM (SELECT a FROM (SELECT '1' AS a UNION SELECT '2' UNION SELECT '3' UNION SELECT '4') AS a JOIN ( SELECT  '1' UNION SELECT '2' UNION SELECT '3' UNION SELECT '4' UNION SELECT '5' UNION SELECT '6' ) AS b ON 1) AS b ,(SELECT @i:=-1)  AS i