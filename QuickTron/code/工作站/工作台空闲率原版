SELECT seq.station_code,

			 (@interval_time*60-sum(CASE WHEN seq.entry_time >= @end_time AND seq.entry_time < DATE_ADD(@end_time,INTERVAL @interval_time MINUTE) AND seq.exit_time < DATE_ADD(@end_time,INTERVAL @interval_time MINUTE) THEN timestampdiff(second,seq.entry_time,seq.exit_time)
                     WHEN seq.entry_time >= @end_time AND seq.entry_time < DATE_ADD(@end_time,INTERVAL @interval_time MINUTE) AND seq.exit_time > DATE_ADD(@end_time,INTERVAL @interval_time MINUTE) THEN timestampdiff(second,seq.entry_time,DATE_ADD(@end_time,INTERVAL @interval_time MINUTE))
                      ELSE 0 END))/(@interval_time*60) as '1',

			 (@interval_time*60-sum(CASE WHEN seq.entry_time >= DATE_ADD(@end_time,INTERVAL @interval_time MINUTE) AND seq.entry_time < DATE_ADD(@end_time,INTERVAL @interval_time*2 MINUTE) AND seq.exit_time < DATE_ADD(@end_time,INTERVAL @interval_time*2 MINUTE) THEN timestampdiff(second,seq.entry_time,seq.exit_time)
                     WHEN seq.entry_time >= DATE_ADD(@end_time,INTERVAL @interval_time MINUTE) AND seq.entry_time < DATE_ADD(@end_time,INTERVAL @interval_time*2 MINUTE) AND seq.exit_time > DATE_ADD(@end_time,INTERVAL @interval_time*2 MINUTE) THEN timestampdiff(second,seq.entry_time,DATE_ADD(@end_time,INTERVAL @interval_time*2 MINUTE))
                     WHEN seq.entry_time < DATE_ADD(@end_time,INTERVAL @interval_time MINUTE) AND seq.entry_time < DATE_ADD(@end_time,INTERVAL @interval_time*2 MINUTE) AND seq.exit_time>= DATE_ADD(@end_time,INTERVAL @interval_time MINUTE) AND seq.exit_time < DATE_ADD(@end_time,INTERVAL @interval_time*2 MINUTE) THEN timestampdiff(second,DATE_ADD(@end_time,INTERVAL @interval_time MINUTE),seq.exit_time)
                     WHEN seq.entry_time < DATE_ADD(@end_time,INTERVAL @interval_time MINUTE) AND seq.entry_time < DATE_ADD(@end_time,INTERVAL @interval_time*2 MINUTE) AND seq.exit_time > DATE_ADD(@end_time,INTERVAL @interval_time*2 MINUTE) THEN timestampdiff(second,DATE_ADD(@end_time,INTERVAL @interval_time MINUTE),DATE_ADD(@end_time,INTERVAL @interval_time*2 MINUTE))
                      ELSE 0 END))/(@interval_time*60) as '2',
			 (@interval_time*60-sum(CASE WHEN seq.entry_time >= DATE_ADD(@end_time,INTERVAL @interval_time*2 MINUTE) AND seq.entry_time < DATE_ADD(@end_time,INTERVAL @interval_time*3 MINUTE) AND seq.exit_time < DATE_ADD(@end_time,INTERVAL @interval_time*3 MINUTE) THEN timestampdiff(second,seq.entry_time,seq.exit_time)
                     WHEN seq.entry_time >= DATE_ADD(@end_time,INTERVAL @interval_time*2 MINUTE) AND seq.entry_time < DATE_ADD(@end_time,INTERVAL @interval_time*3 MINUTE) AND seq.exit_time > DATE_ADD(@end_time,INTERVAL @interval_time*3 MINUTE) THEN timestampdiff(second,seq.entry_time,DATE_ADD(@end_time,INTERVAL @interval_time*3 MINUTE))
                     WHEN seq.entry_time < DATE_ADD(@end_time,INTERVAL @interval_time*2 MINUTE) AND seq.entry_time < DATE_ADD(@end_time,INTERVAL @interval_time*3 MINUTE) AND seq.exit_time>= DATE_ADD(@end_time,INTERVAL @interval_time*2 MINUTE) AND seq.exit_time < DATE_ADD(@end_time,INTERVAL @interval_time*3 MINUTE) THEN timestampdiff(second,DATE_ADD(@end_time,INTERVAL @interval_time*2 MINUTE),seq.exit_time)
                     WHEN seq.entry_time < DATE_ADD(@end_time,INTERVAL @interval_time*2 MINUTE) AND seq.entry_time < DATE_ADD(@end_time,INTERVAL @interval_time*3 MINUTE) AND seq.exit_time > DATE_ADD(@end_time,INTERVAL @interval_time*3 MINUTE) THEN timestampdiff(second,DATE_ADD(@end_time,INTERVAL @interval_time*2 MINUTE),DATE_ADD(@end_time,INTERVAL @interval_time*3 MINUTE))
                      ELSE 0 END))/(@interval_time*60) as '3',
			 (@interval_time*60-sum(CASE WHEN seq.entry_time >= DATE_ADD(@end_time,INTERVAL @interval_time*3 MINUTE) AND seq.entry_time < DATE_ADD(@end_time,INTERVAL @interval_time*4 MINUTE) AND seq.exit_time < DATE_ADD(@end_time,INTERVAL @interval_time*4 MINUTE) THEN timestampdiff(second,seq.entry_time,seq.exit_time)
                     WHEN seq.entry_time >= DATE_ADD(@end_time,INTERVAL @interval_time*3 MINUTE) AND seq.entry_time < DATE_ADD(@end_time,INTERVAL @interval_time*4 MINUTE) AND seq.exit_time > DATE_ADD(@end_time,INTERVAL @interval_time*4 MINUTE) THEN timestampdiff(second,seq.entry_time,DATE_ADD(@end_time,INTERVAL @interval_time*4 MINUTE))
                     WHEN seq.entry_time < DATE_ADD(@end_time,INTERVAL @interval_time*3 MINUTE) AND seq.entry_time < DATE_ADD(@end_time,INTERVAL @interval_time*4 MINUTE) AND seq.exit_time>= DATE_ADD(@end_time,INTERVAL @interval_time*3 MINUTE) AND seq.exit_time < DATE_ADD(@end_time,INTERVAL @interval_time*4 MINUTE) THEN timestampdiff(second,DATE_ADD(@end_time,INTERVAL @interval_time*3 MINUTE),seq.exit_time)
                     WHEN seq.entry_time < DATE_ADD(@end_time,INTERVAL @interval_time*3 MINUTE) AND seq.entry_time < DATE_ADD(@end_time,INTERVAL @interval_time*4 MINUTE) AND seq.exit_time > DATE_ADD(@end_time,INTERVAL @interval_time*4 MINUTE) THEN timestampdiff(second,DATE_ADD(@end_time,INTERVAL @interval_time*3 MINUTE),DATE_ADD(@end_time,INTERVAL @interval_time*4 MINUTE))
                      ELSE 0 END))/(@interval_time*60) as '4',
			 (@interval_time*60-sum(CASE WHEN seq.entry_time >= DATE_ADD(@end_time,INTERVAL @interval_time*4 MINUTE) AND seq.entry_time < DATE_ADD(@end_time,INTERVAL @interval_time*5 MINUTE) AND seq.exit_time < DATE_ADD(@end_time,INTERVAL @interval_time*5 MINUTE) THEN timestampdiff(second,seq.entry_time,seq.exit_time)
                     WHEN seq.entry_time >= DATE_ADD(@end_time,INTERVAL @interval_time*4 MINUTE) AND seq.entry_time < DATE_ADD(@end_time,INTERVAL @interval_time*5 MINUTE) AND seq.exit_time > DATE_ADD(@end_time,INTERVAL @interval_time*5 MINUTE) THEN timestampdiff(second,seq.entry_time,DATE_ADD(@end_time,INTERVAL @interval_time*5 MINUTE))
                     WHEN seq.entry_time < DATE_ADD(@end_time,INTERVAL @interval_time*4 MINUTE) AND seq.entry_time < DATE_ADD(@end_time,INTERVAL @interval_time*5 MINUTE) AND seq.exit_time>= DATE_ADD(@end_time,INTERVAL @interval_time*4 MINUTE) AND seq.exit_time < DATE_ADD(@end_time,INTERVAL @interval_time*5 MINUTE) THEN timestampdiff(second,DATE_ADD(@end_time,INTERVAL @interval_time*4 MINUTE),seq.exit_time)
                     WHEN seq.entry_time < DATE_ADD(@end_time,INTERVAL @interval_time*4 MINUTE) AND seq.entry_time < DATE_ADD(@end_time,INTERVAL @interval_time*5 MINUTE) AND seq.exit_time > DATE_ADD(@end_time,INTERVAL @interval_time*5 MINUTE) THEN timestampdiff(second,DATE_ADD(@end_time,INTERVAL @interval_time*4 MINUTE),DATE_ADD(@end_time,INTERVAL @interval_time*5 MINUTE))
                      ELSE 0 END))/(@interval_time*60) as '5',
			 (@interval_time*60-sum(CASE WHEN seq.entry_time >= DATE_ADD(@end_time,INTERVAL @interval_time*5 MINUTE) AND seq.entry_time < DATE_ADD(@end_time,INTERVAL @interval_time*6 MINUTE) AND seq.exit_time < DATE_ADD(@end_time,INTERVAL @interval_time*6 MINUTE) THEN timestampdiff(second,seq.entry_time,seq.exit_time)
                     WHEN seq.entry_time >= DATE_ADD(@end_time,INTERVAL @interval_time*5 MINUTE) AND seq.entry_time < DATE_ADD(@end_time,INTERVAL @interval_time*6 MINUTE) AND seq.exit_time > DATE_ADD(@end_time,INTERVAL @interval_time*6 MINUTE) THEN timestampdiff(second,seq.entry_time,DATE_ADD(@end_time,INTERVAL @interval_time*6 MINUTE))
                     WHEN seq.entry_time < DATE_ADD(@end_time,INTERVAL @interval_time*5 MINUTE) AND seq.entry_time < DATE_ADD(@end_time,INTERVAL @interval_time*6 MINUTE) AND seq.exit_time>= DATE_ADD(@end_time,INTERVAL @interval_time*5 MINUTE) AND seq.exit_time < DATE_ADD(@end_time,INTERVAL @interval_time*6 MINUTE) THEN timestampdiff(second,DATE_ADD(@end_time,INTERVAL @interval_time*5 MINUTE),seq.exit_time)
                     WHEN seq.entry_time < DATE_ADD(@end_time,INTERVAL @interval_time*5 MINUTE) AND seq.entry_time < DATE_ADD(@end_time,INTERVAL @interval_time*6 MINUTE) AND seq.exit_time > DATE_ADD(@end_time,INTERVAL @interval_time*6 MINUTE) THEN timestampdiff(second,DATE_ADD(@end_time,INTERVAL @interval_time*5 MINUTE),DATE_ADD(@end_time,INTERVAL @interval_time*6 MINUTE))
                      ELSE 0 END))/(@interval_time*60) as '6'

  FROM evo_station.station_entry seq
 WHERE seq.entry_time >= @end_time 
  AND seq.exit_time < DATE_ADD(@end_time,INTERVAL @interval_time*6 MINUTE)
GROUP BY seq.station_code;