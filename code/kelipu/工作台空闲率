SELECT seq.station_code AS 工作站编码,
{{begin_time}} AS 起始时间,
@interval_time :=60 AS 间隔时间,

    (@interval_time * 60 - 
	    sum(CASE WHEN seq.entry_time >= {{begin_time}}  
    	AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time MINUTE)
	    AND seq.exit_time < DATE_ADD({{begin_time}} , INTERVAL @interval_time MINUTE) 
    	THEN timestampdiff(SECOND,seq.entry_time,seq.exit_time)
        WHEN seq.entry_time >= {{begin_time}}  AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time MINUTE) 
		AND seq.exit_time > DATE_ADD({{begin_time}} ,INTERVAL @interval_time MINUTE) 
		THEN timestampdiff(second,seq.entry_time,DATE_ADD({{begin_time}} ,INTERVAL @interval_time MINUTE))
		ELSE 0 END))/(@interval_time*60) as '时间段1',
		
    (@interval_time*60-
	    sum(CASE WHEN seq.entry_time >= DATE_ADD({{begin_time}} ,INTERVAL @interval_time MINUTE) 
    	AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*2 MINUTE)
      	AND seq.exit_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*2 MINUTE)
    	THEN timestampdiff(second,seq.entry_time,seq.exit_time)
        WHEN seq.entry_time >= DATE_ADD({{begin_time}} ,INTERVAL @interval_time MINUTE) 
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*2 MINUTE)
		AND seq.exit_time > DATE_ADD({{begin_time}} ,INTERVAL @interval_time*2 MINUTE) 
		THEN timestampdiff(second,seq.entry_time,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*2 MINUTE))
        WHEN seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time MINUTE) 
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*2 MINUTE) 
		AND seq.exit_time>= DATE_ADD({{begin_time}} ,INTERVAL @interval_time MINUTE)
		AND seq.exit_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*2 MINUTE) 
		THEN timestampdiff(second,DATE_ADD({{begin_time}} ,INTERVAL @interval_time MINUTE),seq.exit_time)
        WHEN seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time MINUTE) 
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*2 MINUTE) 
		AND seq.exit_time > DATE_ADD({{begin_time}} ,INTERVAL @interval_time*2 MINUTE) 
		THEN timestampdiff(second,DATE_ADD({{begin_time}} ,INTERVAL @interval_time MINUTE),DATE_ADD({{begin_time}} ,INTERVAL @interval_time*2 MINUTE))
        ELSE 0 END))/(@interval_time*60) as '时间段2',
		
    (@interval_time*60-
	    sum(CASE WHEN seq.entry_time >= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*2 MINUTE) 
	    AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*3 MINUTE) 
     	AND seq.exit_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*3 MINUTE) 
    	THEN timestampdiff(second,seq.entry_time,seq.exit_time)
        WHEN seq.entry_time >= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*2 MINUTE) 
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*3 MINUTE) 
		AND seq.exit_time > DATE_ADD({{begin_time}} ,INTERVAL @interval_time*3 MINUTE)
		THEN timestampdiff(second,seq.entry_time,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*3 MINUTE))
        WHEN seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*2 MINUTE) 
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*3 MINUTE) 
		AND seq.exit_time>= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*2 MINUTE) 
		AND seq.exit_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*3 MINUTE)
		THEN timestampdiff(second,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*2 MINUTE),seq.exit_time)
        WHEN seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*2 MINUTE)
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*3 MINUTE) 
		AND seq.exit_time > DATE_ADD({{begin_time}} ,INTERVAL @interval_time*3 MINUTE)
		THEN timestampdiff(second,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*2 MINUTE),DATE_ADD({{begin_time}} ,INTERVAL @interval_time*3 MINUTE))
        ELSE 0 END))/(@interval_time*60) as '时间段3',
		
	(@interval_time*60-
	    sum(CASE WHEN seq.entry_time >= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*3 MINUTE) 
	    AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*4 MINUTE) 
		AND seq.exit_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*4 MINUTE) 
		THEN timestampdiff(second,seq.entry_time,seq.exit_time)
        WHEN seq.entry_time >= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*3 MINUTE) 
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*4 MINUTE) 
		AND seq.exit_time > DATE_ADD({{begin_time}} ,INTERVAL @interval_time*4 MINUTE) 
		THEN timestampdiff(second,seq.entry_time,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*4 MINUTE))
        WHEN seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*3 MINUTE) 
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*4 MINUTE)
		AND seq.exit_time>= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*3 MINUTE)
		AND seq.exit_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*4 MINUTE) 
		THEN timestampdiff(second,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*3 MINUTE),seq.exit_time)
        WHEN seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*3 MINUTE) 
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*4 MINUTE) 
		AND seq.exit_time > DATE_ADD({{begin_time}} ,INTERVAL @interval_time*4 MINUTE) 
		THEN timestampdiff(second,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*3 MINUTE),DATE_ADD({{begin_time}} ,INTERVAL @interval_time*4 MINUTE))
        ELSE 0 END))/(@interval_time*60) as '时间段4',
		
	(@interval_time*60-
	    sum(CASE WHEN seq.entry_time >= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*4 MINUTE)
	    AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*5 MINUTE) 
		AND seq.exit_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*5 MINUTE) 
		THEN timestampdiff(second,seq.entry_time,seq.exit_time)
        WHEN seq.entry_time >= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*4 MINUTE) 
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*5 MINUTE) 
		AND seq.exit_time > DATE_ADD({{begin_time}} ,INTERVAL @interval_time*5 MINUTE) 
		THEN timestampdiff(second,seq.entry_time,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*5 MINUTE))
        WHEN seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*4 MINUTE) 
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*5 MINUTE)
		AND seq.exit_time>= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*4 MINUTE) 
		AND seq.exit_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*5 MINUTE) 
		THEN timestampdiff(second,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*4 MINUTE),seq.exit_time)
        WHEN seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*4 MINUTE)
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*5 MINUTE) 
		AND seq.exit_time > DATE_ADD({{begin_time}} ,INTERVAL @interval_time*5 MINUTE)
		THEN timestampdiff(second,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*4 MINUTE),DATE_ADD({{begin_time}} ,INTERVAL @interval_time*5 MINUTE))
        ELSE 0 END))/(@interval_time*60) as '时间段5',
		
	(@interval_time*60-
	    sum(CASE WHEN seq.entry_time >= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*5 MINUTE) 
	    AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*6 MINUTE) 
		AND seq.exit_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*6 MINUTE) 
		THEN timestampdiff(second,seq.entry_time,seq.exit_time)
        WHEN seq.entry_time >= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*5 MINUTE) 
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*6 MINUTE) 
		AND seq.exit_time > DATE_ADD({{begin_time}} ,INTERVAL @interval_time*6 MINUTE) 
		THEN timestampdiff(second,seq.entry_time,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*6 MINUTE))
        WHEN seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*5 MINUTE) 
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*6 MINUTE)
		AND seq.exit_time>= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*5 MINUTE) 
		AND seq.exit_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*6 MINUTE) 
		THEN timestampdiff(second,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*5 MINUTE),seq.exit_time)
        WHEN seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*5 MINUTE)
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*6 MINUTE) 
		AND seq.exit_time > DATE_ADD({{begin_time}} ,INTERVAL @interval_time*6 MINUTE) 
		THEN timestampdiff(second,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*5 MINUTE),DATE_ADD({{begin_time}} ,INTERVAL @interval_time*6 MINUTE))
        ELSE 0 END))/(@interval_time*60) as '时间段6',
		
    (@interval_time*60-
	    sum(CASE WHEN seq.entry_time >= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*6 MINUTE) 
	    AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*7 MINUTE) 
		AND seq.exit_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*7 MINUTE)
		THEN timestampdiff(second,seq.entry_time,seq.exit_time)
        WHEN seq.entry_time >= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*6 MINUTE)
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*7 MINUTE) 
		AND seq.exit_time > DATE_ADD({{begin_time}} ,INTERVAL @interval_time*7 MINUTE)
		THEN timestampdiff(second,seq.entry_time,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*7 MINUTE))
        WHEN seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*6 MINUTE) 
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*7 MINUTE)
		AND seq.exit_time>= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*6 MINUTE) 
		AND seq.exit_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*7 MINUTE) 
		THEN timestampdiff(second,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*6 MINUTE),seq.exit_time)
        WHEN seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*6 MINUTE)
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*7 MINUTE)
		AND seq.exit_time > DATE_ADD({{begin_time}} ,INTERVAL @interval_time*7 MINUTE) 
		THEN timestampdiff(second,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*6 MINUTE),DATE_ADD({{begin_time}} ,INTERVAL @interval_time*7 MINUTE))
        ELSE 0 END))/(@interval_time*60) as '时间段7',
		
	(@interval_time*60-
	    sum(CASE WHEN seq.entry_time >= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*7 MINUTE)
     	AND seq.entry_time < DATE_ADD({{begin_time}} , INTERVAL @interval_time*8 MINUTE) 
		AND seq.exit_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*8 MINUTE) 
		THEN timestampdiff(second,seq.entry_time,seq.exit_time)
        WHEN seq.entry_time >= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*7 MINUTE)
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*8 MINUTE)
		AND seq.exit_time > DATE_ADD({{begin_time}} ,INTERVAL @interval_time*8 MINUTE)
		THEN timestampdiff(second,seq.entry_time,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*8 MINUTE))
        WHEN seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*7 MINUTE)
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*8 MINUTE)
		AND seq.exit_time>= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*7 MINUTE) 
		AND seq.exit_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*8 MINUTE) 
		THEN timestampdiff(second,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*7 MINUTE),seq.exit_time)
        WHEN seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*7 MINUTE) 
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*8 MINUTE) 
		AND seq.exit_time > DATE_ADD({{begin_time}} ,INTERVAL @interval_time*8 MINUTE) 
		THEN timestampdiff(second,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*7 MINUTE),DATE_ADD({{begin_time}} ,INTERVAL @interval_time*8 MINUTE))
        ELSE 0 END))/(@interval_time*60) as '时间段8',
		
	(@interval_time*60-
	    sum(CASE WHEN seq.entry_time >= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*8 MINUTE)
     	AND seq.entry_time < DATE_ADD({{begin_time}} , INTERVAL @interval_time*9 MINUTE) 
		AND seq.exit_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*9 MINUTE) 
		THEN timestampdiff(second,seq.entry_time,seq.exit_time)
        WHEN seq.entry_time >= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*8 MINUTE)
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*9 MINUTE)
		AND seq.exit_time > DATE_ADD({{begin_time}} ,INTERVAL @interval_time*9 MINUTE)
		THEN timestampdiff(second,seq.entry_time,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*9 MINUTE))
        WHEN seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*8 MINUTE)
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*9 MINUTE)
		AND seq.exit_time>= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*8 MINUTE) 
		AND seq.exit_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*9 MINUTE) 
		THEN timestampdiff(second,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*8 MINUTE),seq.exit_time)
        WHEN seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*8 MINUTE) 
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*9 MINUTE) 
		AND seq.exit_time > DATE_ADD({{begin_time}} ,INTERVAL @interval_time*9 MINUTE) 
		THEN timestampdiff(second,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*8 MINUTE),DATE_ADD({{begin_time}} ,INTERVAL @interval_time*9 MINUTE))
        ELSE 0 END))/(@interval_time*60) as '时间段9',
		
    (@interval_time*60-
	    sum(CASE WHEN seq.entry_time >= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*9 MINUTE)
     	AND seq.entry_time < DATE_ADD({{begin_time}} , INTERVAL @interval_time*10 MINUTE) 
		AND seq.exit_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*10 MINUTE) 
		THEN timestampdiff(second,seq.entry_time,seq.exit_time)
        WHEN seq.entry_time >= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*9 MINUTE)
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*10 MINUTE)
		AND seq.exit_time > DATE_ADD({{begin_time}} ,INTERVAL @interval_time*10 MINUTE)
		THEN timestampdiff(second,seq.entry_time,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*10 MINUTE))
        WHEN seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*9 MINUTE)
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*10 MINUTE)
		AND seq.exit_time>= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*9 MINUTE) 
		AND seq.exit_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*10 MINUTE) 
		THEN timestampdiff(second,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*9 MINUTE),seq.exit_time)
        WHEN seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*9 MINUTE) 
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*10 MINUTE) 
		AND seq.exit_time > DATE_ADD({{begin_time}} ,INTERVAL @interval_time*10 MINUTE) 
		THEN timestampdiff(second,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*9 MINUTE),DATE_ADD({{begin_time}} ,INTERVAL @interval_time*10 MINUTE))
        ELSE 0 END))/(@interval_time*60) as '时间段10',
		
		(@interval_time*60-
	    sum(CASE WHEN seq.entry_time >= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*10 MINUTE)
     	AND seq.entry_time < DATE_ADD({{begin_time}} , INTERVAL @interval_time*11 MINUTE) 
		AND seq.exit_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*11 MINUTE) 
		THEN timestampdiff(second,seq.entry_time,seq.exit_time)
        WHEN seq.entry_time >= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*10 MINUTE)
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*11 MINUTE)
		AND seq.exit_time > DATE_ADD({{begin_time}} ,INTERVAL @interval_time*11 MINUTE)
		THEN timestampdiff(second,seq.entry_time,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*11 MINUTE))
        WHEN seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*10 MINUTE)
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*11 MINUTE)
		AND seq.exit_time>= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*10 MINUTE) 
		AND seq.exit_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*11 MINUTE) 
		THEN timestampdiff(second,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*10 MINUTE),seq.exit_time)
        WHEN seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*10 MINUTE) 
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*11 MINUTE) 
		AND seq.exit_time > DATE_ADD({{begin_time}} ,INTERVAL @interval_time*11 MINUTE) 
		THEN timestampdiff(second,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*10 MINUTE),DATE_ADD({{begin_time}} ,INTERVAL @interval_time*11 MINUTE))
        ELSE 0 END))/(@interval_time*60) as '时间段11',
		
		(@interval_time*60-
		sum(CASE WHEN seq.entry_time >= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*11 MINUTE) 
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*12 MINUTE)
		AND seq.exit_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*12 MINUTE) 
		THEN timestampdiff(second,seq.entry_time,seq.exit_time)
        WHEN seq.entry_time >= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*11 MINUTE) 
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*12 MINUTE)
		AND seq.exit_time > DATE_ADD({{begin_time}} ,INTERVAL @interval_time*12 MINUTE) 
		THEN timestampdiff(second,seq.entry_time,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*12 MINUTE))
        WHEN seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*11 MINUTE)
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*12 MINUTE) 
		AND seq.exit_time>= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*11 MINUTE) 
		AND seq.exit_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*12 MINUTE) 
		THEN timestampdiff(second,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*11 MINUTE),seq.exit_time)
        WHEN seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*11 MINUTE)
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*12 MINUTE) 
		AND seq.exit_time > DATE_ADD({{begin_time}} ,INTERVAL @interval_time*12 MINUTE)
		THEN timestampdiff(second,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*11 MINUTE),DATE_ADD({{begin_time}} ,INTERVAL @interval_time*12 MINUTE))
        ELSE 0 END))/(@interval_time*60) as '时间段12',
		
		(@interval_time*60-
		sum(CASE WHEN seq.entry_time >= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*12 MINUTE)
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*13 MINUTE) 
		AND seq.exit_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*13 MINUTE) 
		THEN timestampdiff(second,seq.entry_time,seq.exit_time)
        WHEN seq.entry_time >= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*12 MINUTE) 
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*13 MINUTE)
		AND seq.exit_time > DATE_ADD({{begin_time}} ,INTERVAL @interval_time*13 MINUTE) 
		THEN timestampdiff(second,seq.entry_time,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*13 MINUTE))
        WHEN seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*12 MINUTE) 
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*13 MINUTE) 
		AND seq.exit_time>= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*12 MINUTE) 
		AND seq.exit_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*13 MINUTE) 
		THEN timestampdiff(second,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*12 MINUTE),seq.exit_time)
        WHEN seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*12 MINUTE)
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*13 MINUTE)
		AND seq.exit_time > DATE_ADD({{begin_time}} ,INTERVAL @interval_time*13 MINUTE) 
		THEN timestampdiff(second,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*12 MINUTE),DATE_ADD({{begin_time}} ,INTERVAL @interval_time*13 MINUTE))
        ELSE 0 END))/(@interval_time*60) as '时间段13',
		
		(@interval_time*60
		-sum(CASE WHEN seq.entry_time >= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*13 MINUTE)
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*14 MINUTE) 
		AND seq.exit_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*14 MINUTE)
		THEN timestampdiff(second,seq.entry_time,seq.exit_time)
        WHEN seq.entry_time >= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*13 MINUTE)
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*14 MINUTE) 
		AND seq.exit_time > DATE_ADD({{begin_time}} ,INTERVAL @interval_time*14 MINUTE) 
		THEN timestampdiff(second,seq.entry_time,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*14 MINUTE))
        WHEN seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*13 MINUTE)
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*14 MINUTE) 
		AND seq.exit_time>= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*13 MINUTE)
		AND seq.exit_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*14 MINUTE) 
		THEN timestampdiff(second,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*13 MINUTE),seq.exit_time)
        WHEN seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*13 MINUTE) 
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*14 MINUTE)
		AND seq.exit_time > DATE_ADD({{begin_time}} ,INTERVAL @interval_time*14 MINUTE) 
		THEN timestampdiff(second,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*13 MINUTE),DATE_ADD({{begin_time}} ,INTERVAL @interval_time*14 MINUTE))
        ELSE 0 END))/(@interval_time*60) as '时间段14',
		
		(@interval_time*60
		-sum(CASE WHEN seq.entry_time >= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*14 MINUTE)
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*15 MINUTE) 
		AND seq.exit_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*15 MINUTE)
		THEN timestampdiff(second,seq.entry_time,seq.exit_time)
        WHEN seq.entry_time >= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*14 MINUTE)
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*15 MINUTE) 
		AND seq.exit_time > DATE_ADD({{begin_time}} ,INTERVAL @interval_time*15 MINUTE) 
		THEN timestampdiff(second,seq.entry_time,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*15 MINUTE))
        WHEN seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*14 MINUTE)
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*15 MINUTE) 
		AND seq.exit_time>= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*14 MINUTE)
		AND seq.exit_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*15 MINUTE) 
		THEN timestampdiff(second,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*14 MINUTE),seq.exit_time)
        WHEN seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*14 MINUTE) 
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*15 MINUTE)
		AND seq.exit_time > DATE_ADD({{begin_time}} ,INTERVAL @interval_time*15 MINUTE) 
		THEN timestampdiff(second,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*14 MINUTE),DATE_ADD({{begin_time}} ,INTERVAL @interval_time*15 MINUTE))
        ELSE 0 END))/(@interval_time*60) as '时间段15',
		
		(@interval_time*60
		-sum(CASE WHEN seq.entry_time >= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*15 MINUTE)
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*16 MINUTE) 
		AND seq.exit_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*16 MINUTE)
		THEN timestampdiff(second,seq.entry_time,seq.exit_time)
        WHEN seq.entry_time >= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*15 MINUTE)
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*16 MINUTE) 
		AND seq.exit_time > DATE_ADD({{begin_time}} ,INTERVAL @interval_time*16 MINUTE) 
		THEN timestampdiff(second,seq.entry_time,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*16 MINUTE))
        WHEN seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*15 MINUTE)
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*16 MINUTE) 
		AND seq.exit_time>= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*15 MINUTE)
		AND seq.exit_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*16 MINUTE) 
		THEN timestampdiff(second,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*15 MINUTE),seq.exit_time)
        WHEN seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*15 MINUTE) 
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*16 MINUTE)
		AND seq.exit_time > DATE_ADD({{begin_time}} ,INTERVAL @interval_time*16 MINUTE) 
		THEN timestampdiff(second,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*15 MINUTE),DATE_ADD({{begin_time}} ,INTERVAL @interval_time*16 MINUTE))
        ELSE 0 END))/(@interval_time*60) as '时间段16',
		
		(@interval_time*60
		-sum(CASE WHEN seq.entry_time >= DATE_ADD({{begin_time}} ,INTERVAL @interval_time* 16 MINUTE)
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*17 MINUTE) 
		AND seq.exit_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*17 MINUTE)
		THEN timestampdiff(second,seq.entry_time,seq.exit_time)
        WHEN seq.entry_time >= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*16 MINUTE)
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*17 MINUTE) 
		AND seq.exit_time > DATE_ADD({{begin_time}} ,INTERVAL @interval_time*17 MINUTE) 
		THEN timestampdiff(second,seq.entry_time,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*17 MINUTE))
        WHEN seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*16 MINUTE)
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*17 MINUTE) 
		AND seq.exit_time>= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*16 MINUTE)
		AND seq.exit_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*17 MINUTE) 
		THEN timestampdiff(second,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*16 MINUTE),seq.exit_time)
        WHEN seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*16 MINUTE) 
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*17 MINUTE)
		AND seq.exit_time > DATE_ADD({{begin_time}} ,INTERVAL @interval_time*17 MINUTE) 
		THEN timestampdiff(second,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*16 MINUTE),DATE_ADD({{begin_time}} ,INTERVAL @interval_time*17 MINUTE))
        ELSE 0 END))/(@interval_time*60) as '时间段17',
		
		(@interval_time*60
		-sum(CASE WHEN seq.entry_time >= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*17 MINUTE)
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*18 MINUTE) 
		AND seq.exit_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*18 MINUTE)
		THEN timestampdiff(second,seq.entry_time,seq.exit_time)
        WHEN seq.entry_time >= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*17 MINUTE)
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*18 MINUTE) 
		AND seq.exit_time > DATE_ADD({{begin_time}} ,INTERVAL @interval_time*18 MINUTE) 
		THEN timestampdiff(second,seq.entry_time,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*18 MINUTE))
        WHEN seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*17 MINUTE)
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*18 MINUTE) 
		AND seq.exit_time>= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*17 MINUTE)
		AND seq.exit_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*18 MINUTE) 
		THEN timestampdiff(second,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*17 MINUTE),seq.exit_time)
        WHEN seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*17 MINUTE) 
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*18 MINUTE)
		AND seq.exit_time > DATE_ADD({{begin_time}} ,INTERVAL @interval_time*18 MINUTE) 
		THEN timestampdiff(second,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*17 MINUTE),DATE_ADD({{begin_time}} ,INTERVAL @interval_time*18 MINUTE))
        ELSE 0 END))/(@interval_time*60) as '时间段18',
		
		(@interval_time*60
		-sum(CASE WHEN seq.entry_time >= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*18 MINUTE)
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*19 MINUTE) 
		AND seq.exit_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*19 MINUTE)
		THEN timestampdiff(second,seq.entry_time,seq.exit_time)
        WHEN seq.entry_time >= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*18 MINUTE)
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*19 MINUTE) 
		AND seq.exit_time > DATE_ADD({{begin_time}} ,INTERVAL @interval_time*19 MINUTE) 
		THEN timestampdiff(second,seq.entry_time,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*19 MINUTE))
        WHEN seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*18 MINUTE)
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*19 MINUTE) 
		AND seq.exit_time>= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*18 MINUTE)
		AND seq.exit_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*19 MINUTE) 
		THEN timestampdiff(second,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*18 MINUTE),seq.exit_time)
        WHEN seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*18 MINUTE) 
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*19 MINUTE)
		AND seq.exit_time > DATE_ADD({{begin_time}} ,INTERVAL @interval_time*19 MINUTE) 
		THEN timestampdiff(second,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*18 MINUTE),DATE_ADD({{begin_time}} ,INTERVAL @interval_time*19 MINUTE))
        ELSE 0 END))/(@interval_time*60) as '时间段19',
		
		(@interval_time*60
		-sum(CASE WHEN seq.entry_time >= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*19 MINUTE)
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*20 MINUTE) 
		AND seq.exit_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*20 MINUTE)
		THEN timestampdiff(second,seq.entry_time,seq.exit_time)
        WHEN seq.entry_time >= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*19 MINUTE)
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*20 MINUTE) 
		AND seq.exit_time > DATE_ADD({{begin_time}} ,INTERVAL @interval_time*20 MINUTE) 
		THEN timestampdiff(second,seq.entry_time,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*20 MINUTE))
        WHEN seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*19 MINUTE)
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*20 MINUTE) 
		AND seq.exit_time>= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*19 MINUTE)
		AND seq.exit_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*20 MINUTE) 
		THEN timestampdiff(second,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*19 MINUTE),seq.exit_time)
        WHEN seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*19 MINUTE) 
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*20 MINUTE)
		AND seq.exit_time > DATE_ADD({{begin_time}} ,INTERVAL @interval_time*20 MINUTE) 
		THEN timestampdiff(second,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*19 MINUTE),DATE_ADD({{begin_time}} ,INTERVAL @interval_time*20 MINUTE))
        ELSE 0 END))/(@interval_time*60) as '时间段20',
		
		(@interval_time*60
		-sum(CASE WHEN seq.entry_time >= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*20 MINUTE)
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*21 MINUTE) 
		AND seq.exit_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*21 MINUTE)
		THEN timestampdiff(second,seq.entry_time,seq.exit_time)
        WHEN seq.entry_time >= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*20 MINUTE)
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*21 MINUTE) 
		AND seq.exit_time > DATE_ADD({{begin_time}} ,INTERVAL @interval_time*21 MINUTE) 
		THEN timestampdiff(second,seq.entry_time,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*21 MINUTE))
        WHEN seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*20 MINUTE)
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*21 MINUTE) 
		AND seq.exit_time>= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*20 MINUTE)
		AND seq.exit_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*21 MINUTE) 
		THEN timestampdiff(second,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*20 MINUTE),seq.exit_time)
        WHEN seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*20 MINUTE) 
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*21 MINUTE)
		AND seq.exit_time > DATE_ADD({{begin_time}} ,INTERVAL @interval_time*21 MINUTE) 
		THEN timestampdiff(second,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*20 MINUTE),DATE_ADD({{begin_time}} ,INTERVAL @interval_time*21 MINUTE))
        ELSE 0 END))/(@interval_time*60) as '时间段21',
		
		(@interval_time*60
		-sum(CASE WHEN seq.entry_time >= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*21 MINUTE)
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*22 MINUTE) 
		AND seq.exit_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*22 MINUTE)
		THEN timestampdiff(second,seq.entry_time,seq.exit_time)
        WHEN seq.entry_time >= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*21 MINUTE)
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*22 MINUTE) 
		AND seq.exit_time > DATE_ADD({{begin_time}} ,INTERVAL @interval_time*22 MINUTE) 
		THEN timestampdiff(second,seq.entry_time,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*22 MINUTE))
        WHEN seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*21 MINUTE)
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*22 MINUTE) 
		AND seq.exit_time>= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*21 MINUTE)
		AND seq.exit_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*22 MINUTE) 
		THEN timestampdiff(second,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*21 MINUTE),seq.exit_time)
        WHEN seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*21 MINUTE) 
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*22 MINUTE)
		AND seq.exit_time > DATE_ADD({{begin_time}} ,INTERVAL @interval_time*22 MINUTE) 
		THEN timestampdiff(second,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*21 MINUTE),DATE_ADD({{begin_time}} ,INTERVAL @interval_time*22 MINUTE))
        ELSE 0 END))/(@interval_time*60) as '时间段22',
		
		(@interval_time*60
		-sum(CASE WHEN seq.entry_time >= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*22 MINUTE)
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*23 MINUTE) 
		AND seq.exit_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*23 MINUTE)
		THEN timestampdiff(second,seq.entry_time,seq.exit_time)
        WHEN seq.entry_time >= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*22 MINUTE)
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*23 MINUTE) 
		AND seq.exit_time > DATE_ADD({{begin_time}} ,INTERVAL @interval_time*23 MINUTE) 
		THEN timestampdiff(second,seq.entry_time,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*23 MINUTE))
        WHEN seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*22 MINUTE)
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*23 MINUTE) 
		AND seq.exit_time>= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*22 MINUTE)
		AND seq.exit_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*23 MINUTE) 
		THEN timestampdiff(second,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*22 MINUTE),seq.exit_time)
        WHEN seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*22 MINUTE) 
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*23 MINUTE)
		AND seq.exit_time > DATE_ADD({{begin_time}} ,INTERVAL @interval_time*23 MINUTE) 
		THEN timestampdiff(second,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*22 MINUTE),DATE_ADD({{begin_time}} ,INTERVAL @interval_time*23 MINUTE))
        ELSE 0 END))/(@interval_time*60) as '时间段23',
		
		(@interval_time*60
		-sum(CASE WHEN seq.entry_time >= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*23 MINUTE)
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*24 MINUTE) 
		AND seq.exit_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*24 MINUTE)
		THEN timestampdiff(second,seq.entry_time,seq.exit_time)
        WHEN seq.entry_time >= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*23 MINUTE)
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*24 MINUTE) 
		AND seq.exit_time > DATE_ADD({{begin_time}} ,INTERVAL @interval_time*24 MINUTE) 
		THEN timestampdiff(second,seq.entry_time,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*24 MINUTE))
        WHEN seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*23 MINUTE)
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*24 MINUTE) 
		AND seq.exit_time>= DATE_ADD({{begin_time}} ,INTERVAL @interval_time*23 MINUTE)
		AND seq.exit_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*24 MINUTE) 
		THEN timestampdiff(second,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*23 MINUTE),seq.exit_time)
        WHEN seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*23 MINUTE) 
		AND seq.entry_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*24 MINUTE)
		AND seq.exit_time > DATE_ADD({{begin_time}} ,INTERVAL @interval_time*24 MINUTE) 
		THEN timestampdiff(second,DATE_ADD({{begin_time}} ,INTERVAL @interval_time*23 MINUTE),DATE_ADD({{begin_time}} ,INTERVAL @interval_time*24 MINUTE))
        ELSE 0 END))/(@interval_time*60) as '时间段24'
		

  
  FROM evo_station.station_entry seq

 WHERE seq.entry_time >= {{begin_time}}  
  AND seq.exit_time < DATE_ADD({{begin_time}} ,INTERVAL @interval_time*24 MINUTE)
GROUP BY seq.station_code;